<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1671.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    span.s1 {font: 12.0px 'PingFang SC'}
    span.s2 {font: 12.0px 'Lucida Grande'}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-CN"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;<span class="s1">手势控制</span>3D<span class="s1">圣诞树照片云</span>&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/three@0.158.0/build/three.min.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/three@0.158.0/examples/js/controls/OrbitControls.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/three@0.158.0/examples/js/postprocessing/EffectComposer.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/three@0.158.0/examples/js/postprocessing/RenderPass.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/three@0.158.0/examples/js/postprocessing/UnrealBloomPass.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/three@0.158.0/examples/js/shaders/CopyShader.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/three@0.158.0/examples/js/postprocessing/ShaderPass.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>* {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-sizing: border-box;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #0a0a14;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: relative;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#webgl-canvas {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 1;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#video-container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>right: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 280px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 210px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 2;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid rgba(255, 215, 0, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#input-video {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: scaleX(-1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>object-fit: cover;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#ui-overlay {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 3;</p>
<p class="p1"><span class="Apple-converted-space">            </span>pointer-events: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#title {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 2.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 700;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(90deg, #C9B037, #D4AF37, #FFD700);</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-background-clip: text;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-clip: text;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: transparent;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-shadow: 0 0 15px rgba(255, 215, 0, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#status-panel {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>bottom: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 400px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(20, 40, 20, 0.7);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-left: 4px solid #228B22;</p>
<p class="p1"><span class="Apple-converted-space">            </span>backdrop-filter: blur(10px);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#status-panel h3 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #D4AF37;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.2rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#current-status {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #FFD700;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 700;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#status-description {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.9rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #a0e5a0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#instructions {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>right: 320px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(40, 20, 20, 0.7);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid rgba(220, 20, 60, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">            </span>backdrop-filter: blur(10px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 300px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#instructions h3 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #D4AF37;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#instructions ul {</p>
<p class="p1"><span class="Apple-converted-space">            </span>list-style-type: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#instructions li {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding-left: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: relative;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#instructions li:before {</p>
<p class="p1"><span class="Apple-converted-space">            </span>content: "•";</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #D4AF37;</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#gesture-info {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>bottom: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>right: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(20, 20, 40, 0.7);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px 25px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid rgba(100, 200, 255, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">            </span>backdrop-filter: blur(10px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-width: 180px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#gesture-name {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #00ffff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 700;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#loading {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #0a0a14;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: opacity 0.5s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.loader {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 60px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 60px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 5px solid rgba(34, 139, 34, 0.2);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-top: 5px solid #228B22;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 50%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>animation: spin 1s linear infinite;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>@keyframes spin {</p>
<p class="p1"><span class="Apple-converted-space">            </span>0% { transform: rotate(0deg); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>100% { transform: rotate(360deg); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#photo-upload {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 120px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(20, 40, 20, 0.7);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid rgba(255, 215, 0, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">            </span>backdrop-filter: blur(10px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 300px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>pointer-events: auto;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#photo-upload h3 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #D4AF37;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#file-input {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255, 255, 255, 0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid rgba(255, 215, 0, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#upload-btn {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(90deg, #228B22, #32CD32);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#upload-btn:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(90deg, #32CD32, #228B22);</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-2px);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#element-count {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 120px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>right: 320px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(40, 20, 20, 0.7);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px 25px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid rgba(220, 20, 60, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">            </span>backdrop-filter: blur(10px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#count {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #FFD700;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 700;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;canvas id="webgl-canvas"&gt;&lt;/canvas&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="video-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;video id="input-video" autoplay playsinline&gt;&lt;/video&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="ui-overlay"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h1 id="title"&gt;<span class="s1">手势控制圣诞树照片云</span>&lt;/h1&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="instructions"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;<span class="s1">手势控制说明</span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;li&gt;&lt;strong&gt;<span class="s1">张开五指</span>&lt;/strong&gt; <span class="s2">→</span> <span class="s1">散开状态</span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;li&gt;&lt;strong&gt;<span class="s1">握拳</span>&lt;/strong&gt; <span class="s2">→</span> <span class="s1">合拢为圣诞树</span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;li&gt;&lt;strong&gt;<span class="s1">旋转手部</span>&lt;/strong&gt; <span class="s2">→</span> <span class="s1">旋转视角</span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;li&gt;&lt;strong&gt;<span class="s1">抓取手势</span>&lt;/strong&gt; <span class="s2">→</span> <span class="s1">放大照片</span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="status-panel"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;<span class="s1">当前状态</span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="current-status"&gt;<span class="s1">合拢态</span> (<span class="s1">圣诞树</span>)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="status-description"&gt;<span class="s1">所有元素收拢为圣诞树圆锥体</span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;<span class="s1">元素数量</span>: &lt;span id="total-count"&gt;0&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="photo-upload"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;<span class="s1">上传照片</span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="file" id="file-input" accept="image/*" multiple&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button id="upload-btn"&gt;<span class="s1">添加照片到圣诞树</span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p style="font-size: 0.8rem; color: #aaa; margin-top: 10px;"&gt;<span class="s1">支持</span>JPG<span class="s1">、</span>PNG<span class="s1">格式</span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="element-count"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;<span class="s1">照片数量</span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="count"&gt;0&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="gesture-info"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;<span class="s1">当前手势</span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="gesture-name"&gt;<span class="s1">等待识别</span>...&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="loading"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="loader"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2&gt;<span class="s1">正在加载模型与</span>3D<span class="s1">场景</span>...&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p&gt;<span class="s1">请确保摄像头已启用</span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="s1">主脚本</span></p>
<p class="p1"><span class="Apple-converted-space">        </span>(async function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">全局变量</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let scene, camera, renderer, composer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let controls, bloomPass;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let elements = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>let photos = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>let particleSystem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let handDetected = false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let currentGesture = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>let lastGesture = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>let currentStatus = 'closed'; // closed, scattered, photo-zoomed</p>
<p class="p1"><span class="Apple-converted-space">            </span>let targetStatus = 'closed';</p>
<p class="p1"><span class="Apple-converted-space">            </span>let transitionProgress = 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let transitionSpeed = 0.02;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let rotationEnabled = false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let lastHandPosition = null;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let cameraRotation = { x: 0, y: 0 };</p>
<p class="p1"><span class="Apple-converted-space">            </span>let selectedPhotoIndex = -1;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let photoTextures = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>const ELEMENT_COUNT = 400;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const PHOTO_COUNT = 12;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">初始化</span>Three.js<span class="s1">场景</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function initThreeJS() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建场景</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>scene = new THREE.Scene();</p>
<p class="p1"><span class="Apple-converted-space">                </span>scene.background = new THREE.Color(0x0a0a14);</p>
<p class="p1"><span class="Apple-converted-space">                </span>scene.fog = new THREE.Fog(0x0a0a14, 50, 200);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建相机</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);</p>
<p class="p1"><span class="Apple-converted-space">                </span>camera.position.set(0, 30, 100);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建渲染器</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const canvas = document.getElementById('webgl-canvas');</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderer = new THREE.WebGLRenderer({<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>canvas,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>antialias: true,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>alpha: true</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderer.setSize(window.innerWidth, window.innerHeight);</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderer.shadowMap.enabled = true;</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderer.shadowMap.type = THREE.PCFSoftShadowMap;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建后期处理效果</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>composer = new THREE.EffectComposer(renderer);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const renderPass = new THREE.RenderPass(scene, camera);</p>
<p class="p1"><span class="Apple-converted-space">                </span>composer.addPass(renderPass);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建辉光效果</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>bloomPass = new THREE.UnrealBloomPass(</p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.Vector2(window.innerWidth, window.innerHeight),</p>
<p class="p1"><span class="Apple-converted-space">                    </span>1.5,<span class="Apple-converted-space">  </span>// <span class="s1">强度</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>0.4,<span class="Apple-converted-space">  </span>// <span class="s1">半径</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>0.85<span class="Apple-converted-space">  </span>// <span class="s1">阈值</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>);</p>
<p class="p1"><span class="Apple-converted-space">                </span>composer.addPass(bloomPass);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">添加环境光</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const ambientLight = new THREE.AmbientLight(0x333333);</p>
<p class="p1"><span class="Apple-converted-space">                </span>scene.add(ambientLight);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">添加金色方向光</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const directionalLight = new THREE.DirectionalLight(0xFFD700, 0.8);</p>
<p class="p1"><span class="Apple-converted-space">                </span>directionalLight.position.set(10, 20, 15);</p>
<p class="p1"><span class="Apple-converted-space">                </span>directionalLight.castShadow = true;</p>
<p class="p1"><span class="Apple-converted-space">                </span>scene.add(directionalLight);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">添加红色填充光</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const fillLight = new THREE.DirectionalLight(0xFF3366, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">                </span>fillLight.position.set(-10, 10, -10);</p>
<p class="p1"><span class="Apple-converted-space">                </span>scene.add(fillLight);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">添加点光源营造氛围</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const pointLight = new THREE.PointLight(0x228B22, 0.5, 100);</p>
<p class="p1"><span class="Apple-converted-space">                </span>pointLight.position.set(0, 30, 0);</p>
<p class="p1"><span class="Apple-converted-space">                </span>scene.add(pointLight);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建粒子系统</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>createParticleSystem();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建圣诞树元素</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>createChristmasTreeElements();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建默认照片</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>createDefaultPhotos();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">窗口大小调整处理</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>window.addEventListener('resize', onWindowResize);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">初始化</span>UI</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateUI();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">创建粒子系统</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function createParticleSystem() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const particleCount = 2000;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const particles = new THREE.BufferGeometry();</p>
<p class="p1"><span class="Apple-converted-space">                </span>const positions = new Float32Array(particleCount * 3);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const colors = new Float32Array(particleCount * 3);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">圣诞绿、金色、红色</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const colorPalette = [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.Color(0x228B22), // <span class="s1">森林绿</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.Color(0x32CD32), //<span class="Apple-converted-space">  </span>LimeGreen</p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.Color(0xFFD700), // <span class="s1">金色</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.Color(0xC9B037), // <span class="s1">金属金</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.Color(0xFF3366), // <span class="s1">圣诞红</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.Color(0x8B0000)<span class="Apple-converted-space">  </span>// <span class="s1">深红</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 0; i &lt; particleCount; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const i3 = i * 3;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>positions[i3] = (Math.random() - 0.5) * 200;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>positions[i3 + 1] = Math.random() * 100;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>positions[i3 + 2] = (Math.random() - 0.5) * 200;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">随机选择颜色</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const color = colorPalette[Math.floor(Math.random() * colorPalette.length)];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>colors[i3] = color.r;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>colors[i3 + 1] = color.g;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>colors[i3 + 2] = color.b;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>particles.setAttribute('position', new THREE.BufferAttribute(positions, 3));</p>
<p class="p1"><span class="Apple-converted-space">                </span>particles.setAttribute('color', new THREE.BufferAttribute(colors, 3));</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const particleMaterial = new THREE.PointsMaterial({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>size: 1.5,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>vertexColors: true,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>transparent: true,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>opacity: 0.6,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>blending: THREE.AdditiveBlending</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>particleSystem = new THREE.Points(particles, particleMaterial);</p>
<p class="p1"><span class="Apple-converted-space">                </span>scene.add(particleSystem);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">创建圣诞树元素</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function createChristmasTreeElements() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const geometries = [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.SphereGeometry(1, 8, 8),</p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.BoxGeometry(1.5, 1.5, 1.5),</p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.CylinderGeometry(0.3, 0.3, 3, 6) // <span class="s1">糖果棍</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const materials = [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.MeshStandardMaterial({<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>color: 0x228B22,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>roughness: 0.7,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>metalness: 0.2</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}), // <span class="s1">哑光绿球体</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.MeshStandardMaterial({<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>color: 0xFFD700,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>roughness: 0.3,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>metalness: 0.8</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}), // <span class="s1">金属金立方体</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>new THREE.MeshStandardMaterial({<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>color: 0xFF3366,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>roughness: 0.5,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>metalness: 0.1</p>
<p class="p1"><span class="Apple-converted-space">                    </span>})<span class="Apple-converted-space">  </span>// <span class="s1">圣诞红糖果棍</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 0; i &lt; ELEMENT_COUNT; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const type = Math.floor(Math.random() * geometries.length);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const materialIndex = Math.floor(Math.random() * materials.length);</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const mesh = new THREE.Mesh(geometries[type], materials[materialIndex]);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>mesh.castShadow = true;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>mesh.receiveShadow = true;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">初始位置（将在更新函数中设置）</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>mesh.userData = {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>originalPosition: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>targetPosition: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>velocity: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>type: type,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>index: i</p>
<p class="p1"><span class="Apple-converted-space">                    </span>};</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>elements.push(mesh);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>scene.add(mesh);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">更新</span>UI<span class="s1">计数</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('total-count').textContent = ELEMENT_COUNT;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">创建默认照片</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function createDefaultPhotos() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">创建照片纹理占位符</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const canvas = document.createElement('canvas');</p>
<p class="p1"><span class="Apple-converted-space">                </span>canvas.width = 256;</p>
<p class="p1"><span class="Apple-converted-space">                </span>canvas.height = 256;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const ctx = canvas.getContext('2d');</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">生成一些默认纹理</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const defaultImages = [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ color: '#228B22', text: '<span class="s1">圣诞</span>' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ color: '#FFD700', text: '<span class="s1">快乐</span>' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ color: '#FF3366', text: '2023' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ color: '#8B0000', text: '<span class="s1">节日</span>' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ color: '#32CD32', text: '<span class="s1">平安</span>' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ color: '#C9B037', text: '<span class="s1">喜悦</span>' }</p>
<p class="p1"><span class="Apple-converted-space">                </span>];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 0; i &lt; PHOTO_COUNT; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const imgIndex = i % defaultImages.length;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const imgData = defaultImages[imgIndex];</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">创建纹理</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>ctx.fillStyle = imgData.color;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ctx.fillRect(0, 0, 256, 256);</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>ctx.fillStyle = 'white';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ctx.font = 'bold 40px Arial';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ctx.textAlign = 'center';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ctx.textBaseline = 'middle';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ctx.fillText(imgData.text, 128, 128);</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const texture = new THREE.CanvasTexture(canvas);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>photoTextures.push(texture);</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">创建照片平面</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const photoGeometry = new THREE.PlaneGeometry(8, 8);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const photoMaterial = new THREE.MeshStandardMaterial({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>map: texture,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>side: THREE.DoubleSide,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>roughness: 0.3,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>metalness: 0.1</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const photo = new THREE.Mesh(photoGeometry, photoMaterial);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>photo.castShadow = true;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>photo.receiveShadow = true;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>photo.userData = {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>originalPosition: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>targetPosition: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>velocity: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>isPhoto: true,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>index: i,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>scale: 1</p>
<p class="p1"><span class="Apple-converted-space">                    </span>};</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>photos.push(photo);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>scene.add(photo);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">更新</span>UI<span class="s1">照片计数</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('count').textContent = PHOTO_COUNT;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">更新元素位置（根据当前状态）</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function updateElements() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const allElements = [...elements, ...photos];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">状态过渡</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (currentStatus !== targetStatus) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>transitionProgress += transitionSpeed;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (transitionProgress &gt;= 1) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>transitionProgress = 1;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>currentStatus = targetStatus;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>updateUI();</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (transitionProgress &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>transitionProgress -= transitionSpeed * 0.5;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (transitionProgress &lt; 0) transitionProgress = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">根据状态计算目标位置</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 0; i &lt; allElements.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const element = allElements[i];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const data = element.userData;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>let targetPos = new THREE.Vector3();</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (currentStatus === 'closed' || transitionProgress &lt; 1) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">合拢态：圣诞树圆锥体</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>const progress = (currentStatus === 'closed') ? 1 : 1 - transitionProgress;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (data.isPhoto) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// <span class="s1">照片在圣诞树上部分</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>const height = 30 + (data.index % 6) * 8;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const angle = (data.index * 137.5) * Math.PI / 180; // <span class="s1">黄金角度</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>const radius = 15 * (1 - height / 80);</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.x = Math.cos(angle) * radius * progress;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.y = height * progress;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.z = Math.sin(angle) * radius * progress;</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>// <span class="s1">照片始终面向相机</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>element.lookAt(camera.position);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// <span class="s1">其他元素构成圣诞树</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>const height = Math.random() * 60;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const angle = Math.random() * Math.PI * 2;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const radius = (1 - height / 60) * 25;</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.x = Math.cos(angle) * radius * progress;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.y = height * progress;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.z = Math.sin(angle) * radius * progress;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">散开态位置</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>let scatterPos = new THREE.Vector3();</p>
<p class="p1"><span class="Apple-converted-space">                        </span>scatterPos.x = (Math.random() - 0.5) * 100;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>scatterPos.y = Math.random() * 60;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>scatterPos.z = (Math.random() - 0.5) * 100;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">插值</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>data.targetPosition.lerpVectors(scatterPos, targetPos,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>(currentStatus === 'closed') ? progress : transitionProgress);</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (currentStatus === 'scattered') {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">散开态：随机漂浮</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (!data.originalPosition.equals(data.targetPosition)) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>data.originalPosition.copy(data.targetPosition);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">轻微浮动动画</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>const time = Date.now() * 0.001;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>targetPos.x = data.originalPosition.x + Math.sin(time * 0.5 + i) * 3;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>targetPos.y = data.originalPosition.y + Math.cos(time * 0.3 + i) * 2;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>targetPos.z = data.originalPosition.z + Math.sin(time * 0.4 + i) * 3;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>data.targetPosition.copy(targetPos);</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (currentStatus === 'photo-zoomed' &amp;&amp; selectedPhotoIndex &gt;= 0) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">照片放大态</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>const selectedPhoto = photos[selectedPhotoIndex];</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (element === selectedPhoto) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// <span class="s1">放大选中的照片</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.set(0, 30, 0);</p>
<p class="p1"><span class="Apple-converted-space">                            </span>element.scale.lerp(new THREE.Vector3(3, 3, 3), 0.1);</p>
<p class="p1"><span class="Apple-converted-space">                            </span>element.lookAt(camera.position);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>} else if (data.isPhoto) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// <span class="s1">其他照片移到背景</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>const angle = (data.index * 137.5) * Math.PI / 180;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const radius = 50;</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.x = Math.cos(angle) * radius;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.y = 30;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.z = Math.sin(angle) * radius;</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>element.scale.lerp(new THREE.Vector3(0.5, 0.5, 0.5), 0.1);</p>
<p class="p1"><span class="Apple-converted-space">                            </span>element.lookAt(camera.position);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// <span class="s1">其他元素保持在散开状态</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetPos.copy(data.originalPosition);</p>
<p class="p1"><span class="Apple-converted-space">                            </span>element.scale.lerp(new THREE.Vector3(1, 1, 1), 0.1);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>data.targetPosition.copy(targetPos);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">物理运动（速度</span>+<span class="s1">加速度）</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const acceleration = new THREE.Vector3()</p>
<p class="p1"><span class="Apple-converted-space">                        </span>.subVectors(data.targetPosition, element.position)</p>
<p class="p1"><span class="Apple-converted-space">                        </span>.multiplyScalar(0.05);</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>data.velocity.add(acceleration);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>data.velocity.multiplyScalar(0.95); // <span class="s1">阻尼</span></p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>element.position.add(data.velocity);</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">缓慢旋转</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (currentStatus === 'scattered') {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>element.rotation.x += 0.01;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>element.rotation.y += 0.015;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">更新粒子系统</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (particleSystem) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>particleSystem.rotation.y += 0.002;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">根据状态调整粒子</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const positions = particleSystem.geometry.attributes.position.array;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const time = Date.now() * 0.001;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>for (let i = 0; i &lt; positions.length; i += 3) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (currentStatus === 'closed') {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// <span class="s1">粒子向中心收缩</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>const dx = positions[i];</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const dy = positions[i + 1];</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const dz = positions[i + 2];</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>const dist = Math.sqrt(dx * dx + dy * dy + dz * dz);</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if (dist &gt; 0.1) {</p>
<p class="p1"><span class="Apple-converted-space">                                </span>positions[i] *= 0.995;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>positions[i + 1] *= 0.995;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>positions[i + 2] *= 0.995;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// <span class="s1">粒子轻微浮动</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>positions[i] += Math.sin(time + i) * 0.05;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>positions[i + 1] += Math.cos(time * 0.7 + i) * 0.05;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>positions[i + 2] += Math.sin(time * 0.5 + i) * 0.05;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>particleSystem.geometry.attributes.position.needsUpdate = true;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">手势识别与处理</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function initMediaPipeHands() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const videoElement = document.getElementById('input-video');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const hands = new Hands({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>locateFile: (file) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>hands.setOptions({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>maxNumHands: 1,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>modelComplexity: 1,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>minDetectionConfidence: 0.6,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>minTrackingConfidence: 0.6</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>hands.onResults(onHandResults);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">启动摄像头</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const camera = new Camera(videoElement, {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>onFrame: async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>await hands.send({image: videoElement});</p>
<p class="p1"><span class="Apple-converted-space">                    </span>},</p>
<p class="p1"><span class="Apple-converted-space">                    </span>width: 640,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>height: 480</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>camera.start();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">隐藏加载界面</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('loading').style.opacity = '0';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>document.getElementById('loading').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}, 500);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}, 2500);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">处理手部检测结果</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function onHandResults(results) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>handDetected = results.multiHandLandmarks &amp;&amp; results.multiHandLandmarks.length &gt; 0;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (handDetected) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const landmarks = results.multiHandLandmarks[0];</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">计算手部中心位置</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>let sumX = 0, sumY = 0;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>landmarks.forEach(lm =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sumX += lm.x;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sumY += lm.y;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const centerX = sumX / landmarks.length;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const centerY = sumY / landmarks.length;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">识别手势</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const gesture = recognizeGesture(landmarks);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>currentGesture = gesture;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">更新手势显示</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('gesture-name').textContent =<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>getGestureName(gesture);</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">手势控制逻辑</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (gesture !== lastGesture) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>handleGestureChange(gesture);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>lastGesture = gesture;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">手旋转控制视角</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (rotationEnabled &amp;&amp; lastHandPosition) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const dx = centerX - lastHandPosition.x;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const dy = centerY - lastHandPosition.y;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>cameraRotation.x += dy * 3;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>cameraRotation.y += dx * 3;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">限制旋转角度</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>cameraRotation.x = Math.max(-Math.PI/3, Math.min(Math.PI/3, cameraRotation.x));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>lastHandPosition = { x: centerX, y: centerY };</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>currentGesture = '';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('gesture-name').textContent = "<span class="s1">等待识别</span>...";</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">手势识别函数</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function recognizeGesture(landmarks) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">获取关键点</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const wrist = landmarks[0];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const thumbTip = landmarks[4];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const indexTip = landmarks[8];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const middleTip = landmarks[12];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const ringTip = landmarks[16];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const pinkyTip = landmarks[20];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">计算指尖到手腕的距离</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const distance = (p1, p2) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const dx = p1.x - p2.x;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const dy = p1.y - p2.y;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const dz = p1.z - p2.z;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return Math.sqrt(dx * dx + dy * dy + dz * dz);</p>
<p class="p1"><span class="Apple-converted-space">                </span>};</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const thumbDistance = distance(thumbTip, wrist);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const indexDistance = distance(indexTip, wrist);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const middleDistance = distance(middleTip, wrist);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const ringDistance = distance(ringTip, wrist);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const pinkyDistance = distance(pinkyTip, wrist);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">计算所有指尖距离的平均值</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const avgDistance = (thumbDistance + indexDistance + middleDistance + ringDistance + pinkyDistance) / 5;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">判断手指是否伸直</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const isThumbExtended = thumbDistance &gt; avgDistance * 0.7;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const isIndexExtended = indexDistance &gt; avgDistance * 0.9;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const isMiddleExtended = middleDistance &gt; avgDistance * 0.9;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const isRingExtended = ringDistance &gt; avgDistance * 0.9;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const isPinkyExtended = pinkyDistance &gt; avgDistance * 0.9;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">手势判断</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const extendedFingers = [isIndexExtended, isMiddleExtended, isRingExtended, isPinkyExtended].filter(v =&gt; v).length;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">握拳：所有手指都不伸直</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!isIndexExtended &amp;&amp; !isMiddleExtended &amp;&amp; !isRingExtended &amp;&amp; !isPinkyExtended) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return 'fist';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">张开手：所有手指都伸直</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>else if (isIndexExtended &amp;&amp; isMiddleExtended &amp;&amp; isRingExtended &amp;&amp; isPinkyExtended) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return 'open_hand';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">抓取手势：只有拇指和食指伸直并靠近</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>else if (isThumbExtended &amp;&amp; isIndexExtended &amp;&amp; !isMiddleExtended &amp;&amp; !isRingExtended &amp;&amp; !isPinkyExtended) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// <span class="s1">检查拇指和食指是否靠近</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const thumbIndexDistance = distance(thumbTip, indexTip);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (thumbIndexDistance &lt; avgDistance * 0.5) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return 'pinch';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">如果手指部分伸直，可能是在旋转</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (extendedFingers &gt;= 2) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return 'rotation';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>return 'unknown';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">获取手势名称</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function getGestureName(gesture) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>switch(gesture) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'open_hand': return '<span class="s1">张开手</span>';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'fist': return '<span class="s1">握拳</span>';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'pinch': return '<span class="s1">抓取</span>';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'rotation': return '<span class="s1">旋转</span>';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>default: return '<span class="s1">其他手势</span>';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">处理手势变化</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function handleGestureChange(gesture) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>switch(gesture) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'open_hand':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">进入散开态</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (currentStatus !== 'scattered') {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetStatus = 'scattered';</p>
<p class="p1"><span class="Apple-converted-space">                            </span>transitionProgress = 0;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>rotationEnabled = true;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'fist':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">回到合拢态</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (currentStatus !== 'closed') {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetStatus = 'closed';</p>
<p class="p1"><span class="Apple-converted-space">                            </span>transitionProgress = 0;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>rotationEnabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>selectedPhotoIndex = -1;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'pinch':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">抓取照片（随机选择一张）</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (currentStatus === 'scattered') {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>selectedPhotoIndex = Math.floor(Math.random() * photos.length);</p>
<p class="p1"><span class="Apple-converted-space">                            </span>targetStatus = 'photo-zoomed';</p>
<p class="p1"><span class="Apple-converted-space">                            </span>transitionProgress = 0;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>rotationEnabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'rotation':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// <span class="s1">启用旋转</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (currentStatus === 'scattered') {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>rotationEnabled = true;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>updateUI();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">更新</span>UI</p>
<p class="p1"><span class="Apple-converted-space">            </span>function updateUI() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const statusElement = document.getElementById('current-status');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const descElement = document.getElementById('status-description');</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>switch(targetStatus) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'closed':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>statusElement.textContent = '<span class="s1">合拢态</span> (<span class="s1">圣诞树</span>)';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>statusElement.style.color = '#32CD32';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>descElement.textContent = '<span class="s1">所有元素收拢为圣诞树圆锥体</span>';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'scattered':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>statusElement.textContent = '<span class="s1">散开态</span>';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>statusElement.style.color = '#FFD700';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>descElement.textContent = '<span class="s1">所有元素在空间中无序漂浮、散落</span>';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'photo-zoomed':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>statusElement.textContent = '<span class="s1">照片放大态</span>';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>statusElement.style.color = '#FF3366';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>descElement.textContent = selectedPhotoIndex &gt;= 0 ?<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>`<span class="s1">正在放大第</span> ${selectedPhotoIndex + 1} <span class="s1">张照片</span>` :<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>'<span class="s1">放大单张照片</span>';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">窗口大小调整处理</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function onWindowResize() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>camera.aspect = window.innerWidth / window.innerHeight;</p>
<p class="p1"><span class="Apple-converted-space">                </span>camera.updateProjectionMatrix();</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderer.setSize(window.innerWidth, window.innerHeight);</p>
<p class="p1"><span class="Apple-converted-space">                </span>composer.setSize(window.innerWidth, window.innerHeight);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">照片上传功能</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function initPhotoUpload() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const fileInput = document.getElementById('file-input');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const uploadBtn = document.getElementById('upload-btn');</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>uploadBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>fileInput.click();</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>fileInput.addEventListener('change', (event) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const files = event.target.files;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (files.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>for (let i = 0; i &lt; Math.min(files.length, 5); i++) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const file = files[i];</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const reader = new FileReader();</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>reader.onload = (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                                </span>const img = new Image();</p>
<p class="p1"><span class="Apple-converted-space">                                </span>img.onload = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>// <span class="s1">创建纹理</span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const canvas = document.createElement('canvas');</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>canvas.width = 256;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>canvas.height = 256;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const ctx = canvas.getContext('2d');</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>// <span class="s1">绘制图片到</span>canvas</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const scale = Math.min(256 / img.width, 256 / img.height);</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const width = img.width * scale;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const height = img.height * scale;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const x = (256 - width) / 2;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const y = (256 - height) / 2;</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>ctx.drawImage(img, x, y, width, height);</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>// <span class="s1">添加边框</span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>ctx.strokeStyle = '#FFD700';</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>ctx.lineWidth = 5;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>ctx.strokeRect(0, 0, 256, 256);</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const texture = new THREE.CanvasTexture(canvas);</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>photoTextures.push(texture);</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>// <span class="s1">创建新的照片平面</span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const photoGeometry = new THREE.PlaneGeometry(8, 8);</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const photoMaterial = new THREE.MeshStandardMaterial({</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>map: texture,</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>side: THREE.DoubleSide,</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>roughness: 0.3,</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>metalness: 0.1</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>const photo = new THREE.Mesh(photoGeometry, photoMaterial);</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>photo.castShadow = true;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>photo.receiveShadow = true;</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>photo.userData = {</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>originalPosition: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>targetPosition: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>velocity: new THREE.Vector3(),</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>isPhoto: true,</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>index: photos.length,</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>scale: 1</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>};</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>photos.push(photo);</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>scene.add(photo);</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>// <span class="s1">更新</span>UI<span class="s1">照片计数</span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>document.getElementById('count').textContent = photos.length;</p>
<p class="p2"><span class="Apple-converted-space">                                    </span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>// <span class="s1">短暂提示</span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>uploadBtn.textContent = '<span class="s1">上传成功</span>!';</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>uploadBtn.textContent = '<span class="s1">添加照片到圣诞树</span>';</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>}, 2000);</p>
<p class="p1"><span class="Apple-converted-space">                                </span>};</p>
<p class="p1"><span class="Apple-converted-space">                                </span>img.src = e.target.result;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>};</p>
<p class="p1"><span class="Apple-converted-space">                            </span>reader.readAsDataURL(file);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">动画循环</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function animate() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>requestAnimationFrame(animate);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">更新元素位置</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>updateElements();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">更新相机旋转</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (rotationEnabled) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>camera.position.x = 100 * Math.sin(cameraRotation.y);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>camera.position.z = 100 * Math.cos(cameraRotation.y);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>camera.position.y = 30 + cameraRotation.x * 30;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>camera.lookAt(0, 30, 0);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// <span class="s1">渲染场景</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>composer.render();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">初始化应用</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>async function init() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>initThreeJS();</p>
<p class="p1"><span class="Apple-converted-space">                </span>await initMediaPipeHands();</p>
<p class="p1"><span class="Apple-converted-space">                </span>initPhotoUpload();</p>
<p class="p1"><span class="Apple-converted-space">                </span>animate();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// <span class="s1">启动应用</span></p>
<p class="p1"><span class="Apple-converted-space">            </span>init();</p>
<p class="p1"><span class="Apple-converted-space">        </span>})();</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
